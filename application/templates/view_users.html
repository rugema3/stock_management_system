<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>View Users</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='table_styles.css') }}">
    <link rel="stylesheet" href="https://maxst.icons8.com/vue-static/landings/line-awesome/line-awesome/1.3.0/css/line-awesome.min.css">
</head>
<body class="selected-body">
    {% include 'sidebar.html' %}
    
    <h1>All Users:</h1><br>

    {% if users %}
        <table>
            <tr>
                <th>Name</th>
                <th>Email</th>
                <th>Role</th>
                <th>Department</th>
                <th>Actions</th>
            </tr>
            {% for user in users %}
                <tr>
                    <td>{{ user.name }}</td>
                    <td>{{ user.email }}</td>
                    <td>{{ user.role.upper() }}</td>
                    <td>{{ user.department.upper() }}</td>
                    <td>
                        <!-- Update options dropdown -->
                        <form action="/admin/view_users" method="POST">
                            <input type="hidden" name="user_id" value="{{ user.id }}">
                            <select name="update_option" onchange="updateInputFields(this)">
                                <option value="" disabled selected>Select an option</option>
				    <option value="new_email">Update Email</option>
                                <option value="new_password">Update Password</option>
                                <option value="new_name">Update Name</option>
                            </select>
                            <input id="new_email" type="text" name="new_email" placeholder="New Email" style="display: none;">
                            <input id="new_password" type="password" name="new_password" placeholder="New Password" style="display: none;">
                            <input id="new_name" type="text" name="new_name" placeholder="New Name" style="display: none;">
                            <button type="submit">Update</button>
                        </form>
                    </td>
                </tr>
            {% endfor %}
        </table>
    {% else %}
        <p>No users found.</p>
    {% endif %}

    <p class="back-button"><a href="/admin">Back</a></p>

    <script>
    function updateInputFields(selectElement) {
        var selectedOption = selectElement.options[selectElement.selectedIndex].value;
        var inputFields = document.querySelectorAll('[id^="new_"]');
        inputFields.forEach(function(inputField) {
            inputField.style.display = "none"; // Hide all input fields
        });
        var selectedInputField = document.getElementById(selectedOption);
        if (selectedInputField) {
            selectedInputField.style.display = "block"; // Show selected input field
        }
    }
</script>
</body>
</html>

